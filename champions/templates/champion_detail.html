<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ champion.name }}</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #1a1a1a;
            color: white;
            text-align: center;
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 1200px;
            margin: auto;
            padding: 20px;
        }

        h1, h2 {
            color: #ffcc00;
        }

        .section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #444;
            border-radius: 10px;
            background-color: #2a2a2a;
        }

        .abilities {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }

        .ability-icon {
            position: relative;
            display: inline-block;
            text-align: center;
        }

        .ability-icon img {
            width: 64px;
            height: 64px;
            margin-bottom: 5px;
            border-radius: 8px;
            transition: transform 0.2s;
        }

        .ability-icon img:hover {
            transform: scale(1.1);
        }

        .tooltip {
            visibility: hidden;
            background-color: #333;
            color: #fff;
            text-align: left;
            padding: 10px;
            border-radius: 5px;
            position: absolute;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
            white-space: normal;
            width: 250px;
            font-size: 14px;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .ability-icon:hover .tooltip {
            visibility: visible;
            opacity: 1;
        }

        .stats {
            margin: 20px 0;
            text-align: left;
            font-size: 16px;
        }

        .stats span {
            font-weight: bold;
            color: #50fa7b;
        }

        select {
            padding: 10px;
            background-color: #444;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .slots {
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .slot {
            width: 64px;
            height: 64px;
            background-color: #444;
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            position: relative;
        }

        .slot img {
            max-width: 100%;
            max-height: 100%;
        }

        /* Tooltip para slots */
        .slot .tooltip {
            visibility: hidden;
            background-color: #333;
            color: #fff;
            text-align: left;
            padding: 10px;
            border-radius: 5px;
            position: absolute;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
            white-space: normal;
            width: 200px;
            font-size: 14px;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .slot:hover .tooltip {
            visibility: visible;
            opacity: 1;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: #2a2a2a;
            padding: 20px;
            border-radius: 10px;
            max-width: 800px;
            max-height: 80%;
            overflow-y: auto;
        }

        .modal-content img {
            width: 64px;
            height: 64px;
            margin: 10px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .modal-content img:hover {
            transform: scale(1.1);
        }

        .close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 24px;
            color: white;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>{{ champion.name }} - {{ champion.title }}</h1>
        <img src="https://ddragon.leagueoflegends.com/cdn/13.20.1/img/champion/{{ champion.image.full }}" alt="{{ champion.name }}">

        <!-- Habilidades -->
        <div class="section">
            <h2>Habilidades</h2>
            <div class="abilities">
                <div class="ability-icon">
                    <img src="https://ddragon.leagueoflegends.com/cdn/13.20.1/img/passive/{{ champion.passive.image.full }}" alt="{{ champion.passive.name }}">
                    <p>{{ champion.passive.name }}</p>
                    <div class="tooltip">
                        <strong>{{ champion.passive.name }}</strong><br>
                        {{ champion.passive.description }}
                    </div>
                </div>
                {% for spell in champion.spells %}
                <div class="ability-icon">
                    <img src="https://ddragon.leagueoflegends.com/cdn/13.20.1/img/spell/{{ spell.image.full }}" alt="{{ spell.name }}">
                    <p>{{ spell.name }}</p>
                    <div class="tooltip">
                        <strong>{{ spell.name }}</strong><br>
                        {{ spell.description }}
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>

        <!-- Estadísticas -->
        <div class="section">
            <h2>Estadísticas del Campeón</h2>
            <div>
                <label for="champion-level">Selecciona Nivel:</label>
                <select id="champion-level">
                    {% for level in levels %}
                    <option value="{{ level }}">{{ level }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="stats">
                <p>Vida: <span id="stat-hp">{{ champion.stats.hp }}</span></p>
                <p>Mana: <span id="stat-mp">{{ champion.stats.mp }}</span></p>
                <p>Armadura: <span id="stat-armor">{{ champion.stats.armor }}</span></p>
                <p>Resistencia Mágica: <span id="stat-spellblock">{{ champion.stats.spellblock }}</span></p>
                <p>Daño de Ataque: <span id="stat-ad">{{ champion.stats.attackdamage }}</span></p>
            </div>
        </div>

        <!-- Selección de Objetos -->
        <div class="section">
            <h2>Seleccionar Objetos</h2>
            <div class="slots">
                <div class="slot" data-slot="boots">
                    +
                    <div class="tooltip"></div>
                </div>
                <div class="slot" data-slot="item1">
                    +
                    <div class="tooltip"></div>
                </div>
                <div class="slot" data-slot="item2">
                    +
                    <div class="tooltip"></div>
                </div>
                <div class="slot" data-slot="item3">
                    +
                    <div class="tooltip"></div>
                </div>
                <div class="slot" data-slot="item4">
                    +
                    <div class="tooltip"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="close-btn">×</span>
            <div id="modal-items"></div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
    // Estadísticas base del campeón
    const baseStats = {
        hp: {{ champion.stats.hp }},
        hpPerLevel: {{ champion.stats.hpperlevel }},
        mp: {{ champion.stats.mp }},
        mpPerLevel: {{ champion.stats.mpperlevel }},
        armor: {{ champion.stats.armor }},
        armorPerLevel: {{ champion.stats.armorperlevel }},
        spellblock: {{ champion.stats.spellblock }},
        spellblockPerLevel: {{ champion.stats.spellblockperlevel }},
        attackdamage: {{ champion.stats.attackdamage }},
        attackdamagePerLevel: {{ champion.stats.attackdamageperlevel }},
    };

    const levelSelect = document.getElementById('champion-level');

    // Actualizar estadísticas según el nivel seleccionado
    const updateStats = () => {
        const level = parseInt(levelSelect.value, 10) || 1;
        document.getElementById('stat-hp').textContent = (baseStats.hp + baseStats.hpPerLevel * (level - 1)).toFixed(1);
        document.getElementById('stat-mp').textContent = (baseStats.mp + baseStats.mpPerLevel * (level - 1)).toFixed(1);
        document.getElementById('stat-armor').textContent = (baseStats.armor + baseStats.armorPerLevel * (level - 1)).toFixed(1);
        document.getElementById('stat-spellblock').textContent = (baseStats.spellblock + baseStats.spellblockPerLevel * (level - 1)).toFixed(1);
        document.getElementById('stat-ad').textContent = (baseStats.attackdamage + baseStats.attackdamagePerLevel * (level - 1)).toFixed(1);

        console.log(`Estadísticas actualizadas para nivel ${level}`);
    };

    levelSelect.addEventListener('change', updateStats);
    updateStats(); // Llamar para inicializar las estadísticas al cargar la página

    // Datos de la API
    const itemsData = JSON.parse('{{ items|escapejs }}');
    const bootsData = JSON.parse('{{ boots|escapejs }}');
    let currentSlot = null;

    // Abrir modal de selección de objetos
    function openModal(slot) {
        currentSlot = slot;
        const modal = document.getElementById('modal');
        const modalItems = document.getElementById('modal-items');
        modal.style.display = 'flex';
        modalItems.innerHTML = '';

        const data = slot === 'boots' ? bootsData : itemsData;

        for (const [id, item] of Object.entries(data)) {
            const img = document.createElement('img');
            img.src = `https://ddragon.leagueoflegends.com/cdn/13.20.1/img/item/${id}.png`;
            img.alt = item.name || 'Item desconocido';
            img.title = `${item.name}\n${item.plaintext || 'Sin descripción'}\n${JSON.stringify(item.stats || {}, null, 2)}`;

            img.addEventListener('click', () => selectItem(slot, id, item)); // Pasar el objeto completo
            modalItems.appendChild(img);
        }
    }

    // Cerrar el modal
    function closeModal() {
        const modal = document.getElementById('modal');
        modal.style.display = 'none';
    }

    // Seleccionar un objeto y actualizar el slot
    function selectItem(slot, id, item) {
        console.log(`Seleccionando item para slot: ${slot}`, item);

        const slotDiv = document.querySelector(`.slot[data-slot="${slot}"]`);

        if (!slotDiv) {
            console.error(`Slot no encontrado para: ${slot}`);
            return;
        }

        slotDiv.innerHTML = `
            <img src="https://ddragon.leagueoflegends.com/cdn/13.20.1/img/item/${id}.png" alt="${item.name}">
            <div class="tooltip">
                <strong>${item.name}</strong><br>
                ${item.plaintext || 'Sin descripción'}<br>
                ${Object.entries(item.stats || {})
                    .map(([stat, value]) => `${stat}: ${value}`)
                    .join('<br>')}
            </div>
        `;

        console.log(`Slot actualizado: ${slot}`, slotDiv.innerHTML);
        closeModal();
    }

    // Event listeners
    document.querySelectorAll('.slot').forEach(slot => {
        slot.addEventListener('click', () => openModal(slot.getAttribute('data-slot')));
    });

    document.querySelector('.close-btn').addEventListener('click', closeModal);

    document.addEventListener('click', (e) => {
        const modal = document.getElementById('modal');
        if (e.target === modal) closeModal();
    });
});



    </script>
    
</body>
</html>
